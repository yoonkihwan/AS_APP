# 사내용 AS 시스템 개발 명세서

## 1. 프로젝트 개요

- **프로젝트명:** 사내용 AS 관리 시스템 (Internal AS System)
- **목표:** AS 입고부터 수리, 출고, 이력 관리까지의 전 과정을 전산화하여 업무 효율성 증대 및 데이터 누락 방지.
- **핵심 가치:** 쉽고 빠른 입력(드롭다운, 일괄 입고), 정확한 이력 추적, 마스터 데이터 기반의 체계적 관리.

---

## 2. 기술 스택 (Tech Stack)

| 구분            | 기술              | 설명                                                            |
| :-------------- | :---------------- | :-------------------------------------------------------------- |
| **Language**    | **Python**        | 전체 비즈니스 로직 처리 및 백엔드 구현                          |
| **Framework**   | **Django**        | 웹 애플리케이션 프레임워크 (MVT 패턴, ORM 활용)                 |
| **Database**    | **SQLite** (초기) | 개발 및 초기 단계용 내장 DB (추후 PostgreSQL 마이그레이션 고려) |
| **Frontend/UI** | **Django Unfold** | Django Admin을 현대적인 UI로 커스터마이징하여 대시보드 구축     |
| **Editor**      | **VS Code**       | 통합 개발 환경                                                  |

---

## 3. 기능 요구사항 목록 (Feature List)

### 3.1. 우선순위 P0 (핵심 기능 - MVP) ✅ 구현 완료

| 우선순위 | 카테고리        | 상세 요구사항                                                                                                                                        | 구현 상태 |
| :------: | :-------------- | :--------------------------------------------------------------------------------------------------------------------------------------------------- | :-------: |
|  **P0**  | **마스터 관리** | **업체 관리:** 업체명, 업체 구분(매출처/의뢰처), 단가 그룹, 지역/국가, 주소                                                                         |     ✅     |
|  **P0**  | **마스터 관리** | **단가 그룹:** 견적서 금액이 다르게 적용되는 업체 그룹 관리 (업체 관리에서 통합)                                                                     |     ✅     |
|  **P0**  | **마스터 관리** | **브랜드 & 툴 관리:** 브랜드별 장비/툴을 통합 관리 (브랜드 상세에서 툴 인라인 편집)                                                                  |     ✅     |
|  **P0**  | **마스터 관리** | **부품 관리:** 부품명, 부품코드, 단가, 구분(전용/공용), 적용 장비(M2M - 다중 선택 가능)                                                               |     ✅     |
|  **P0**  | **AS 입고**     | **일괄 입고 등록:** 공통 정보(날짜/업체/담당자)를 1번 입력 후, 품목별(장비/시리얼/증상) 행을 인라인으로 다중 추가                                      |     ✅     |
|  **P0**  | **AS 출고**     | **출고 처리:** '수리 완료' 상태인 툴만 필터링하여 선택.<br>**다중 출고:** 여러 건을 선택하여 한 번에 출고 처리                                         |     ✅     |
|  **P0**  | **AS 기록**     | **수리 내역 입력:** 현재 AS 진행 중인(입고된) 툴을 필터링하여 선택.<br>**부품 연동:** 마스터 관리의 '수리 품목'을 불러와 사용된 부품 기록               |     ✅     |
|  **P0**  | **AS 이력**     | **통합 조회:** 입고~출고까지의 전체 이력을 엑셀 형식의 표(Grid)로 조회.<br>**검색:** 필드별 상세 검색 지원.<br>**권한:** 데이터 수정 불가(Read-only)     |     ✅     |

### 3.2. 우선순위 P1 (고도화 기능)

| 우선순위 | 카테고리        | 상세 요구사항                                                                                                                  | 구현 상태 |
| :------: | :-------------- | :----------------------------------------------------------------------------------------------------------------------------- | :-------: |
|  **P1**  | **마스터 관리** | **단가 관리:** 수리 품목별 단가를 단가 그룹에 따라 차등 적용                                                                   |     ⬜     |
|  **P1**  | **마스터 관리** | **분해도 연동:** 툴의 분해도 이미지를 등록하고, 이미지 클릭 시 부품 정보가 기입되도록 연동                                     |     ⬜     |
|  **P1**  | **견적서**      | **견적서 생성:** 기존 엑셀 폼 양식에 데이터를 매핑하여 파일 추출.<br>**유형:** 수리 완료 견적서, 수리 대기(가견적서) 추출 기능   |     ⬜     |

---

## 4. 데이터베이스 설계 (Schema Design)

### 4.1. 마스터 데이터 (Master Data)

- **CompanyCategory (단가 그룹):** 단가 그룹명 — 견적서 금액을 업체별로 다르게 적용하기 위한 그룹 (예: A등급, B등급, 특별단가)
- **Company (업체):** 업체명, 업체 구분(매출처/의뢰처/양쪽), 단가 그룹(FK), 지역/국가, 주소
- **Brand (브랜드):** 브랜드명
- **Tool (장비/툴):** 브랜드(FK), 모델명
- **Part (부품/수리품목):** 적용 장비(M2M - 여러 툴에 적용 가능), 부품명, 부품코드, 단가, 구분(전용/공용)

### 4.2. AS 프로세스 데이터 (Transaction Data)

#### **입고 배치 (InboundBatch)**

동일 업체/날짜의 여러 품목을 한 번에 입고 등록합니다.

| 필드명 (Field)  | 데이터 타입 | 설명               | 비고                             |
| :-------------- | :---------- | :----------------- | :------------------------------- |
| `inbound_date`  | Date        | 입고 날짜          |                                  |
| `company`       | FK          | 업체 (마스터 연동) |                                  |
| `manager`       | Char        | 담당자             |                                  |
| `memo`          | Text        | 메모               | 입고 건 참고사항                 |
| `created_at`    | DateTime    | 생성일             | 자동                             |

#### **AS 접수 및 이력 (ASTicket)**

입고부터 출고까지 하나의 티켓으로 관리하며, 단계별로 업데이트합니다.

| 필드명 (Field)    | 데이터 타입 | 설명                    | 비고                      |
| :---------------- | :---------- | :---------------------- | :------------------------ |
| **입고 정보**     |             |                         |                           |
| `inbound_batch`   | FK          | 입고 배치 (선택)        | 일괄 입고 시 자동 연결    |
| `inbound_date`    | Date        | 입고 날짜               | 배치에서 자동 복사        |
| `company`         | FK          | 업체 (마스터 연동)      | 배치에서 자동 복사        |
| `manager`         | Char        | 담당자                  | 배치에서 자동 복사        |
| `tool`            | FK          | 품목/툴 (마스터 연동)   |                           |
| `serial_number`   | Char        | 시리얼 번호             | 식별자                    |
| `symptom`         | Text        | 요청사항 및 증상        | 스킵 가능                 |
| **수리 정보**     |             |                         |                           |
| `repair_content`  | Text        | AS 내용 (수리 내역)     |                           |
| `used_parts`      | M2M         | 사용 부품 (마스터 연동) | 다중 선택 가능            |
| `repair_cost`     | Integer     | AS 비용 (부품비 + 공임) | 자동 계산 권장            |
| `status`          | Choice      | 상태                    | 입고/수리대기/수리완료/출고 |
| **출고 및 정산**  |             |                         |                           |
| `outbound_date`   | Date        | 출고 날짜               | 출고 시 업데이트          |
| `estimate_status` | Boolean     | 견적서 추출 상태        |                           |
| `tax_invoice`     | Boolean     | 세금계산서 발행 여부    |                           |

---

## 5. UI/UX 가이드라인 (Django Unfold)

Django Unfold 라이브러리를 활용하여 다음과 같이 구성합니다.

1.  **사이드바 네비게이션:**
    - **AS 관리:** 입고 등록 / 수리 기록 / 출고 처리 / 통합 이력
    - **견적 관리:** 견적서 발행 / 발행 이력 (P1)
    - **기준 정보:** 업체 관리 / 브랜드 & 툴 관리 / 부품 관리

2.  **입고 등록 (InboundBatch):**
    - 상단: 공통 정보(입고일, 업체, 담당자)를 1번만 입력
    - 하단: `TabularInline`으로 품목별 행(장비, 시리얼, 증상) 추가/삭제
    - 저장 시 공통 정보가 각 ASTicket에 자동 복사

3.  **마스터 데이터 통합 관리:**
    - **브랜드 & 툴:** 브랜드 상세 페이지에서 `ToolInline`으로 툴 직접 편집
    - **단가 그룹:** 업체 추가/수정 시 드롭다운의 `+` 버튼으로 즉시 생성
    - **부품:** `filter_horizontal`으로 여러 툴에 적용 가능한 부품 관리

4.  **입력 화면 (Form):**
    - `Autocomplete Select`: 업체, 툴 선택 시 검색 가능한 드롭다운 적용.
5.  **목록 화면 (List):**
    - **필터(Filters):** 날짜별, 업체별, 상태별(입고/수리완료 등) 사이드 필터 적용.
    - **검색(Search):** 시리얼 번호, 업체명 통합 검색창.
    - **액션(Actions):** 목록에서 체크박스 선택 후 "선택된 항목 출고 처리" 버튼 배치.

---

## 6. 개발 로드맵 (Roadmap)

1.  ✅ **환경 설정:** Django 프로젝트 생성, Unfold 설치, SQLite 연동.
2.  ✅ **마스터 모델 구현:** Company, Brand, Tool, Part 모델 정의 및 Admin 등록.
3.  ✅ **핵심 로직 구현 (P0):**
    - ASTicket, InboundBatch 모델 생성.
    - 입고(일괄 등록), 수리(Update), 출고(Update) 로직 구현.
    - Admin 커스터마이징 (필터, 검색, 인라인, 액션).
4.  ✅ **UI 개선:** Django Unfold 테마 적용 및 사이드바 구성.
5.  ⬜ **고도화 (P1):** 단가 그룹별 가격 관리, 엑셀 견적서 출력, 분해도 이미지 매핑.
